<app-header></app-header>
<div *ngIf="!isConnected; else connectedBlock" class="buttons-container">
  Connect wallet to access the app
</div>
<ng-template #connectedBlock>
  <ng-container
    [ngTemplateOutlet]="isLoading ? loading : selectedLand ? villageView : lands.length ? landNotSelected : noLands"></ng-container>
  <ng-template #loading>
      <span class="flex items-center justify-center">
        <mat-progress-spinner [diameter]="15" mode="indeterminate"></mat-progress-spinner> Loading...
      </span>
  </ng-template>
  <ng-template #villageView>
    <div class="flex flex-wrap village-view-container">
      <img src="assets/Village/village_background.png" alt="Village view">
      <div class="buildings-container">
        <div class="flex pt-2">
          <div class="relative w-64">
            <img src="assets/Land/t{{selectedLand!.tier}}.png" class="w-64" alt="Tier {{selectedLand!.tier}} land">
            <div class="absolute top-5 right-5 text-white flex flex-col">
              <span>ID: {{selectedLand!.id}}</span>
              <span>ChunkID: {{selectedLand!.chunkID}}</span>
              <span>Tier: {{selectedLand!.tier}}</span>
            </div>
            <div class="absolute left-5 bottom-5">
              <button mat-raised-button
                      (click)="isPathFinished ? onClickUnstake() : openUnstakeConfirmationDialog()"
                      [color]="isPathFinished ? 'primary' : 'warn'">Unstake
              </button>
            </div>
          </div>
          <h2 class="text-white p-2">King needed to upgrade a building: {{ king }}</h2>
        </div>
        <div class="pl-2">
          <button mat-raised-button class="btn btn-primary w-100" (click)="openKingVaultDialog()">
            King rewards vault
          </button>
        </div>
        <app-clickable-building *ngFor="let building of buildings" [building]="building" (onLoadData)="loadData()"
                                [stakeCompleteTimestamp]="stakeCompleteTimestamp"></app-clickable-building>
      </div>
    </div>
  </ng-template>
  <ng-template #landNotSelected>
    <div *ngIf="lands.length; else noLands" class="lands-display">
      <app-select-land *ngFor="let land of lands" [land]="land" (selectedLand)="onSelect($event)"></app-select-land>
    </div>
  </ng-template>
  <ng-template #noLands>
    <div>
      You do not have lands available
    </div>
  </ng-template>
</ng-template>
